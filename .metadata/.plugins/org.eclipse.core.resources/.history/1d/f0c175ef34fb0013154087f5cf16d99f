package com.decker.smrsremote;

import java.io.*;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.net.SocketException;
import java.net.UnknownHostException;



import android.content.Context;
public class UdpClient 
{
	private InetAddress URL = null;
	private final String firstMessage = "hello";
	private Boolean canSend = false;
	private DatagramSocket socket = null;
	private DatagramPacket sendP = null;
	private DatagramPacket recieveP = null;
	private byte[] sendData;
	private byte[] recieveData;
	
	
	UdpClient( Context context, String address)
	{
		sendData = firstMessage.getBytes();
		recieveData = new byte[100];
		
		try{	
		URL = InetAddress.getByName(address);
		sendP= new DatagramPacket(sendData,sendData.length,URL,3444);
		recieveP = new DatagramPacket(recieveData,recieveData.length);
		canSend = true;
		}
		catch(UnknownHostException ex){
			canSend = false;
			ToastMessage.showToast(context,"UnknownHostException: Please check URL");
		}
		try {
			socket = new DatagramSocket();
			socket.setSoTimeout(10000);
			canSend = true;
			} 
		catch (SocketException e) {
			canSend = false;
			ToastMessage.showToast(context,"SocketException: Unable to create socket");
		}
		
		
	}
	public Boolean Start()
	{
		if(canSend != false)
		{
			try {
				socket.send(sendP);
				socket.receive(recieveP);
			} 
			catch (IOException e) {
				return false;
			}
			return canSend;
		}
		return canSend;
	}
	private void Respond()
	{
		
	}

}
